
alter view view_poline
as
select PC01001,PC03002,SC01001,SC01002,SC01003,PL01001,PL01002,convert(numeric(15,3),PC03010) as PC03010,
RTRIM(CHAPUR.SCUN003) UNITPUR,CASE SC01140 WHEN 0 THEN convert(numeric(15,3),PC03011) ELSE convert(numeric(15,3),PC03011*SC01140) END AS PC03011,
case WHEN SC01140=0 THEN convert(numeric(15,3),(PC03010-PC03011)) ELSE convert(numeric(15,3),(PC03010-PC03011)*SC01140) end AS DH,
RTRIM(CHASTC.SCUN003) UNIT,PC03035,'32' Company,SC01069 UQTY from PC033200 INNER JOIN PC013200 ON PC03001=PC01001
left JOIN PL013200 ON PC01003=PL01001
left JOIN SC013200 ON SC01001=PC03005
left JOIN SCUN3200 CHASTC ON CHASTC.SCUN001=SC01133 AND CHASTC.SCUN002='CHA'
left JOIN SCUN3200 CHAPUR ON CHAPUR.SCUN001=SC01134 AND CHAPUR.SCUN002='CHA'
union all
select PC01001,PC03002,SC01001,SC01002,SC01003,PL01001,PL01002,convert(numeric(15,3),PC03010) as PC03010,
RTRIM(CHAPUR.SCUN003) UNITPUR,CASE SC01140 WHEN 0 THEN convert(numeric(15,3),PC03011) ELSE convert(numeric(15,3),PC03011*SC01140) END AS PC03011,
case WHEN SC01140=0 THEN convert(numeric(15,3),(PC03010-PC03011)) ELSE convert(numeric(15,3),(PC03010-PC03011)*SC01140) end AS DH,
RTRIM(CHASTC.SCUN003) UNIT,PC03035,'31' Company,SC01069 UQTY from PC033100 INNER JOIN PC013100 ON PC03001=PC01001
left JOIN PL013100 ON PC01003=PL01001
left JOIN SC013100 ON SC01001=PC03005
left JOIN SCUN3100 CHASTC ON CHASTC.SCUN001=SC01133 AND CHASTC.SCUN002='CHA'
left JOIN SCUN3100 CHAPUR ON CHAPUR.SCUN001=SC01134 AND CHAPUR.SCUN002='CHA'

select * from view_poline
select * from SCUN3200
select * from PC013200

alter view view_warehouse
as
select SC36001,SC36002,SC36003,'32' Company from SC363200
union all
select SC36001,SC36002,SC36003,'31' Company from SC363100


alter view view_WOLine
as
SELECT RTRIM(MP65004) StockCode,RTRIM(SUM(MP65007)) PlanQty,RTRIM(CHA.SCUN003) Unit,SC01002+'-'+SC01003 StockName,MP65003,MP65001,'32' Company FROM MP653200 
INNER JOIN SCUN3200 CHA ON CHA.SCUN001=MP65036 AND CHA.SCUN002='CHA' 
left join SC013200 sc on MP65004=sc.SC01001
group by MP65004,MP65007,SCUN003,SC01002,SC01003,MP65003,MP65001
union all
SELECT RTRIM(MP65004) StockCode,RTRIM(SUM(MP65007)) PlanQty,RTRIM(CHA.SCUN003) Unit,SC01002+'-'+SC01003 StockName,MP65003,MP65001,'31' Company FROM MP653100 
INNER JOIN SCUN3100 CHA ON CHA.SCUN001=MP65036 AND CHA.SCUN002='CHA' 
left join SC013100 sc on MP65004=sc.SC01001 
group by MP65004,MP65007,SCUN003,SC01002,SC01003,MP65003,MP65001


alter view view_WO
as
select MP64001,MP64002,SC01002,SC01003,SC01072,MP64003,MP64004,MP64005,RTRIM(SCUN003) UNIT,'32' Company from MP643200
inner join SC013200 ON SC01001=MP64002 
INNER JOIN SCUN3200 CHA ON CHA.SCUN001=SC01133 AND CHA.SCUN002='CHA'
union all
select MP64001,MP64002,SC01002,SC01003,SC01072,MP64003,MP64004,MP64005,RTRIM(SCUN003) UNIT,'31' Company from MP643100
inner join SC013100 ON SC01001=MP64002 
INNER JOIN SCUN3100 CHA ON CHA.SCUN001=SC01133 AND CHA.SCUN002='CHA'

create view view_Stock
as
select SC01001,SC01002,SC01003,RTRIM(SCUN003) UNIT,'32' Company from SC013200
INNER JOIN SCUN3200 CHA ON SCUN001=SC01133 AND SCUN002='CHA'
union all
select SC01001,SC01002,SC01003,RTRIM(SCUN003) UNIT,'31' Company from SC013100
INNER JOIN SCUN3100 CHA ON SCUN001=SC01133 AND SCUN002='CHA'

create view view_Workcenter
as
select MP50001,MP50002,'32' Company from MP503200
union all
select MP50001,MP50002,'31' Company from MP503100

create view view_SOLine
as
select OR01001,OR01003,SL01002,OR03002,OR03005,OR03006,OR03007,OR03008,OR03011,RTRIM(SCUN003) UNIT,OR01015,'32' Company from OR013200
inner join SL013200 ON SL01001=OR01003
inner join OR033200 on OR03001=OR01001
inner join SCUN3200 CHA ON SCUN001=OR03010 AND SCUN002='CHA'
union all
select OR01001,OR01003,SL01002,OR03002,OR03005,OR03006,OR03007,OR03008,OR03011,RTRIM(SCUN003) UNIT,OR01015,'31' Company from OR013100
inner join SL013100 ON SL01001=OR01003
inner join OR033100 on OR03001=OR01001
inner join SCUN3100 CHA ON SCUN001=OR03010 AND SCUN002='CHA'

select * from OR033200

select * from OR013200





drop view view_WO
select * from MP643200

select * from SY243200